{"version":3,"sources":["versionExecPath.ts"],"sourcesContent":["const path = require('path');\nconst accessSync = require('fs-access-sync-compat');\nconst constants = require('./constants');\n\nconst SLEEP_MS = 200;\nconst installVersion = path.join(__dirname, 'installVersion.js');\n\nlet resolveVersion = null; // break dependencies\nexport default function versionExecPath(version) {\n  if (!resolveVersion) resolveVersion = require('node-resolve-versions'); // break dependencies\n\n  const versions = require('node-resolve-versions').sync(version);\n  if (versions.length > 1) throw new Error('Multiple versions match: ' + version + ' = ' + versions.join(',') + '. Please be specific');\n  const installPath = path.join(constants.installDirectory, versions[0]);\n  const binRoot = constants.isWindows ? installPath : path.join(installPath, 'bin');\n  const execPath = path.join(binRoot, constants.node);\n\n  try {\n    // check installed\n    accessSync(execPath);\n  } catch (err) {\n    // need to install\n    require('function-exec-sync')({ cwd: process.cwd(), sleep: SLEEP_MS, callbacks: true }, installVersion, versions[0]);\n    accessSync(execPath);\n  }\n  return execPath;\n}\n"],"names":["versionExecPath","path","require","accessSync","constants","SLEEP_MS","installVersion","join","__dirname","resolveVersion","version","versions","sync","length","Error","installPath","installDirectory","binRoot","isWindows","execPath","node","err","cwd","process","sleep","callbacks"],"mappings":"AAAA;;;;+BAQA,SAkBC;;;eAlBuBA,eAAe;;;AARvC,IAAMC,IAAI,GAAGC,OAAO,CAAC,MAAM,CAAC,AAAC;AAC7B,IAAMC,UAAU,GAAGD,OAAO,CAAC,uBAAuB,CAAC,AAAC;AACpD,IAAME,SAAS,GAAGF,OAAO,CAAC,aAAa,CAAC,AAAC;AAEzC,IAAMG,QAAQ,GAAG,GAAG,AAAC;AACrB,IAAMC,cAAc,GAAGL,IAAI,CAACM,IAAI,CAACC,SAAS,EAAE,mBAAmB,CAAC,AAAC;AAEjE,IAAIC,cAAc,GAAG,IAAI,AAAC,EAAC,qBAAqB;AACjC,SAAST,eAAe,CAACU,OAAO,EAAE;IAC/C,IAAI,CAACD,cAAc,EAAEA,cAAc,GAAGP,OAAO,CAAC,uBAAuB,CAAC,CAAC,CAAC,qBAAqB;IAE7F,IAAMS,QAAQ,GAAGT,OAAO,CAAC,uBAAuB,CAAC,CAACU,IAAI,CAACF,OAAO,CAAC,AAAC;IAChE,IAAIC,QAAQ,CAACE,MAAM,GAAG,CAAC,EAAE,MAAM,IAAIC,KAAK,CAAC,2BAA2B,GAAGJ,OAAO,GAAG,KAAK,GAAGC,QAAQ,CAACJ,IAAI,CAAC,GAAG,CAAC,GAAG,sBAAsB,CAAC,CAAC;IACtI,IAAMQ,WAAW,GAAGd,IAAI,CAACM,IAAI,CAACH,SAAS,CAACY,gBAAgB,EAAEL,QAAQ,CAAC,CAAC,CAAC,CAAC,AAAC;IACvE,IAAMM,OAAO,GAAGb,SAAS,CAACc,SAAS,GAAGH,WAAW,GAAGd,IAAI,CAACM,IAAI,CAACQ,WAAW,EAAE,KAAK,CAAC,AAAC;IAClF,IAAMI,QAAQ,GAAGlB,IAAI,CAACM,IAAI,CAACU,OAAO,EAAEb,SAAS,CAACgB,IAAI,CAAC,AAAC;IAEpD,IAAI;QACF,kBAAkB;QAClBjB,UAAU,CAACgB,QAAQ,CAAC,CAAC;KACtB,CAAC,OAAOE,GAAG,EAAE;QACZ,kBAAkB;QAClBnB,OAAO,CAAC,oBAAoB,CAAC,CAAC;YAAEoB,GAAG,EAAEC,OAAO,CAACD,GAAG,EAAE;YAAEE,KAAK,EAAEnB,QAAQ;YAAEoB,SAAS,EAAE,IAAI;SAAE,EAAEnB,cAAc,EAAEK,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;QACrHR,UAAU,CAACgB,QAAQ,CAAC,CAAC;KACtB;IACD,OAAOA,QAAQ,CAAC;CACjB"}